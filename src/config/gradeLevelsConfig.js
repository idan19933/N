// src/config/gradeLevelsConfig.js - Israeli Curriculum
/**
 * âœ… ×ª×¦×•×¨×ª ×›×™×ª×•×ª ×•× ×•×©××™× - ×ª×›× ×™×ª ×œ×™×ž×•×“×™× ×™×©×¨××œ×™×ª
 */

const topicsByGrade = {
    '7': ['×ž×¡×¤×¨×™× ×˜×‘×¢×™×™× ×•×©×œ×ž×™×', '×—×–×§×•×ª ×•×©×•×¨×©×™×', '×‘×™×˜×•×™×™× ××œ×’×‘×¨×™×™×', '×ž×©×•×•××•×ª ×¤×©×•×˜×•×ª', '××—×•×–×™× ×•×™×—×¡×™×', '×’××•×ž×˜×¨×™×” ×‘×¡×™×¡×™×ª'],
    '8': ['×ž×©×•×•××•×ª ×•××™-×©×•×•×™×•× ×•×ª', '×‘×™×˜×•×™×™× ××œ×’×‘×¨×™×™× ×ž×•×¨×›×‘×™×', '×¤×¨×•×¤×•×¨×¦×™×” ×•×™×—×¡×™×', '×“×ž×™×•×Ÿ ×•×ž×©×•×œ×©×™×', '×ž×¢×’×œ', '×’×¨×¤×™× ×©×œ ×¤×•× ×§×¦×™×•×ª'],
    '9': ['×—×–×§×•×ª ×•×©×•×¨×©×™× ×¨×™×‘×•×¢×™×™×', '×ž×©×•×•××•×ª ×¨×™×‘×•×¢×™×•×ª', '×’××•×ž×˜×¨×™×” ×ž×ª×§×“×ž×ª', '×¤×•× ×§×¦×™×•×ª ×§×•×•×™×•×ª ×•×¨×™×‘×•×¢×™×•×ª', '×”×¡×ª×‘×¨×•×ª'],
    '10-3': ['××œ×’×‘×¨×” ×‘×¡×™×¡×™×ª', '×ž×©×•×•××•×ª ×¨×™×‘×•×¢×™×•×ª', '×¤×•× ×§×¦×™×•×ª', '×’××•×ž×˜×¨×™×” ×× ×œ×™×˜×™×ª', '×˜×¨×™×’×•× ×•×ž×˜×¨×™×” ×‘×¡×™×¡×™×ª'],
    '10-4': ['×ž×©×•×•××•×ª ×ž×¢×¨×™×›×™×•×ª', '×¤×•× ×§×¦×™×•×ª ×ž×¢×¨×™×›×™×•×ª ×•×œ×•×’×¨×™×ª×ž×™×•×ª', '×˜×¨×™×’×•× ×•×ž×˜×¨×™×”', '×’××•×ž×˜×¨×™×” ×× ×œ×™×˜×™×ª', '×¡×“×¨×•×ª'],
    '10-5': ['×¤×•× ×§×¦×™×•×ª ×ž×ª×§×“×ž×•×ª', '×˜×¨×™×’×•× ×•×ž×˜×¨×™×” ×ž×ª×§×“×ž×ª', '×’××•×ž×˜×¨×™×” ×× ×œ×™×˜×™×ª', '×¡×“×¨×•×ª', '× ×’×–×¨×•×ª ×‘×¡×™×¡×™×•×ª'],
    '11-3': ['×¤×•× ×§×¦×™×•×ª ×¨×™×‘×•×¢×™×•×ª ×•×ž×¢×¨×™×›×™×•×ª', '×‘×¢×™×•×ª ×§×™×¦×•×Ÿ', '×˜×¨×™×’×•× ×•×ž×˜×¨×™×” ×‘×ž×¨×—×‘', '×”×¡×ª×‘×¨×•×ª'],
    '11-4': ['×—×©×‘×•×Ÿ ×“×™×¤×¨× ×¦×™××œ×™', '×¤×•× ×§×¦×™×•×ª ×ž×¢×¨×™×›×™×•×ª', '×’××•×ž×˜×¨×™×” ×‘×ž×¨×—×‘', '×˜×¨×™×’×•× ×•×ž×˜×¨×™×” ×ž×ª×§×“×ž×ª', '×”×¡×ª×‘×¨×•×ª ×ž×•×ª× ×™×ª'],
    '11-5': ['×—×©×‘×•×Ÿ ×“×™×¤×¨× ×¦×™××œ×™ ×ž×ª×§×“×', '×’××•×ž×˜×¨×™×” ×‘×ž×¨×—×‘', '×¤×•× ×§×¦×™×•×ª ×ž×ª×§×“×ž×•×ª', '×˜×¨×™×’×•× ×•×ž×˜×¨×™×” ×‘×ž×¨×—×‘', '×”×¡×ª×‘×¨×•×ª ×‘×™× ×•×ž×™×ª'],
    '12-3': ['×—×–×¨×” ×›×œ×œ×™×ª', '×¤×•× ×§×¦×™×•×ª ×ž×¢×¨×™×›×™×•×ª ×‘×¡×™×¡×™×•×ª', '×’×¨×¤×™×', '×”×›× ×” ×œ×‘×’×¨×•×ª'],
    '12-4': ['××™× ×˜×’×¨×œ×™×', '× ×’×–×¨×•×ª ×•××•×¤×˜×™×ž×™×–×¦×™×”', '×‘×¢×™×•×ª ×§×™×¦×•×Ÿ', '×”×¡×ª×‘×¨×•×ª ×ž×ª×§×“×ž×ª'],
    '12-5': ['××™× ×˜×’×¨×œ×™× ×ž×ª×§×“×ž×™×', '××•×¤×˜×™×ž×™×–×¦×™×”', '×¡×“×¨×•×ª ××™× ×¡×•×¤×™×•×ª', '×”×¡×ª×‘×¨×•×ª ×¨×¦×™×¤×”']
};

const topicIcons = {
    // Grade 7-9
    '×ž×¡×¤×¨×™× ×˜×‘×¢×™×™× ×•×©×œ×ž×™×': 'ðŸ”¢',
    '×—×–×§×•×ª ×•×©×•×¨×©×™×': 'ðŸ“',
    '×‘×™×˜×•×™×™× ××œ×’×‘×¨×™×™×': 'ðŸ§®',
    '×ž×©×•×•××•×ª ×¤×©×•×˜×•×ª': 'âš–ï¸',
    '××—×•×–×™× ×•×™×—×¡×™×': 'ðŸ’¯',
    '×’××•×ž×˜×¨×™×” ×‘×¡×™×¡×™×ª': 'ðŸ“',
    '×ž×©×•×•××•×ª ×•××™-×©×•×•×™×•× ×•×ª': 'âš–ï¸',
    '×‘×™×˜×•×™×™× ××œ×’×‘×¨×™×™× ×ž×•×¨×›×‘×™×': 'ðŸ§®',
    '×¤×¨×•×¤×•×¨×¦×™×” ×•×™×—×¡×™×': 'ðŸ“Š',
    '×“×ž×™×•×Ÿ ×•×ž×©×•×œ×©×™×': 'ðŸ”º',
    '×ž×¢×’×œ': 'â­•',
    '×’×¨×¤×™× ×©×œ ×¤×•× ×§×¦×™×•×ª': 'ðŸ“ˆ',
    '×—×–×§×•×ª ×•×©×•×¨×©×™× ×¨×™×‘×•×¢×™×™×': 'âˆš',
    '×ž×©×•×•××•×ª ×¨×™×‘×•×¢×™×•×ª': 'xÂ²',
    '×’××•×ž×˜×¨×™×” ×ž×ª×§×“×ž×ª': 'ðŸ“',
    '×¤×•× ×§×¦×™×•×ª ×§×•×•×™×•×ª ×•×¨×™×‘×•×¢×™×•×ª': 'ðŸ“ˆ',
    '×”×¡×ª×‘×¨×•×ª': 'ðŸŽ²',

    // High School
    '××œ×’×‘×¨×” ×‘×¡×™×¡×™×ª': 'ðŸ§®',
    '×ž×©×•×•××•×ª ×¨×™×‘×•×¢×™×•×ª': 'xÂ²',
    '×¤×•× ×§×¦×™×•×ª': 'ðŸ“ˆ',
    '×’××•×ž×˜×¨×™×” ×× ×œ×™×˜×™×ª': 'ðŸ“',
    '×˜×¨×™×’×•× ×•×ž×˜×¨×™×” ×‘×¡×™×¡×™×ª': 'ðŸ“',
    '×ž×©×•×•××•×ª ×ž×¢×¨×™×›×™×•×ª': 'eË£',
    '×¤×•× ×§×¦×™×•×ª ×ž×¢×¨×™×›×™×•×ª ×•×œ×•×’×¨×™×ª×ž×™×•×ª': 'log',
    '×˜×¨×™×’×•× ×•×ž×˜×¨×™×”': 'sin',
    '×¡×“×¨×•×ª': 'âˆ‘',
    '×¤×•× ×§×¦×™×•×ª ×ž×ª×§×“×ž×•×ª': 'âˆ«',
    '×˜×¨×™×’×•× ×•×ž×˜×¨×™×” ×ž×ª×§×“×ž×ª': 'cos',
    '× ×’×–×¨×•×ª ×‘×¡×™×¡×™×•×ª': "f'",
    '×¤×•× ×§×¦×™×•×ª ×¨×™×‘×•×¢×™×•×ª ×•×ž×¢×¨×™×›×™×•×ª': 'ðŸ“Š',
    '×‘×¢×™×•×ª ×§×™×¦×•×Ÿ': 'â›°ï¸',
    '×˜×¨×™×’×•× ×•×ž×˜×¨×™×” ×‘×ž×¨×—×‘': 'ðŸŒ',
    '×—×©×‘×•×Ÿ ×“×™×¤×¨× ×¦×™××œ×™': "âˆ‚",
    '×’××•×ž×˜×¨×™×” ×‘×ž×¨×—×‘': 'ðŸ“¦',
    '×”×¡×ª×‘×¨×•×ª ×ž×•×ª× ×™×ª': 'P(A|B)',
    '×—×©×‘×•×Ÿ ×“×™×¤×¨× ×¦×™××œ×™ ×ž×ª×§×“×': 'âˆ‡',
    '×”×¡×ª×‘×¨×•×ª ×‘×™× ×•×ž×™×ª': 'ðŸŽ²',
    '×—×–×¨×” ×›×œ×œ×™×ª': 'ðŸ“š',
    '×¤×•× ×§×¦×™×•×ª ×ž×¢×¨×™×›×™×•×ª ×‘×¡×™×¡×™×•×ª': 'eË£',
    '×’×¨×¤×™×': 'ðŸ“ˆ',
    '×”×›× ×” ×œ×‘×’×¨×•×ª': 'ðŸŽ“',
    '××™× ×˜×’×¨×œ×™×': 'âˆ«',
    '× ×’×–×¨×•×ª ×•××•×¤×˜×™×ž×™×–×¦×™×”': "f'",
    '××™× ×˜×’×¨×œ×™× ×ž×ª×§×“×ž×™×': 'âˆ«âˆ«',
    '××•×¤×˜×™×ž×™×–×¦×™×”': 'ðŸ“Š',
    '×¡×“×¨×•×ª ××™× ×¡×•×¤×™×•×ª': 'âˆž',
    '×”×¡×ª×‘×¨×•×ª ×¨×¦×™×¤×”': 'ðŸ“ˆ'
};

// Question templates by topic
const topicTemplates = {
    '×ž×©×•×•××•×ª ×¤×©×•×˜×•×ª': [
        { type: 'equation', difficulty: 'easy', maxCoef: 5 },
        { type: 'equation', difficulty: 'medium', maxCoef: 10 }
    ],
    '××—×•×–×™× ×•×™×—×¡×™×': [
        { type: 'percentage', difficulty: 'easy' }
    ],
    '×ž×©×•×•××•×ª ×¨×™×‘×•×¢×™×•×ª': [
        { type: 'quadratic', difficulty: 'medium' }
    ],
    // Default template for all topics
    'default': [
        { type: 'equation', difficulty: 'easy', maxCoef: 10 }
    ]
};

/**
 * Get grade configuration for a student
 */
export const getGradeConfig = (nexonProfile) => {
    if (!nexonProfile || !nexonProfile.grade) {
        return null;
    }

    const grade = nexonProfile.grade;
    const track = nexonProfile.track;

    // Build grade key
    let gradeKey = grade;
    if (parseInt(grade) >= 10 && track) {
        const trackNum = track.includes('3') ? '3' : track.includes('4') ? '4' : track.includes('5') ? '5' : '';
        gradeKey = `${grade}-${trackNum}`;
    }

    const topics = topicsByGrade[gradeKey] || [];

    return {
        id: gradeKey,
        name: `×›×™×ª×” ${grade}` + (track ? ` (${track})` : ''),
        emoji: grade === '7' ? '7ï¸âƒ£' : grade === '8' ? '8ï¸âƒ£' : grade === '9' ? '9ï¸âƒ£' :
            grade === '10' ? 'ðŸ”Ÿ' : grade === '11' ? '1ï¸âƒ£1ï¸âƒ£' : '1ï¸âƒ£2ï¸âƒ£',
        range: [1, 100],
        topics: topics.map(topicName => ({
            id: topicName.replace(/\s+/g, '-'),
            name: topicName,
            icon: topicIcons[topicName] || 'ðŸ“š',
            mastery: nexonProfile.topicMastery?.[topicName] || 'unknown',
            templates: topicTemplates[topicName] || topicTemplates.default
        }))
    };
};

/**
 * Get prioritized topics (weak topics first)
 */
export const getPrioritizedTopics = (nexonProfile) => {
    const gradeConfig = getGradeConfig(nexonProfile);
    if (!gradeConfig) return [];

    const topics = gradeConfig.topics;

    // Sort by mastery level: struggle -> needs-work -> good -> unknown
    const priorityOrder = { 'struggle': 0, 'needs-work': 1, 'unknown': 2, 'good': 3 };

    return topics.sort((a, b) => {
        const aPriority = priorityOrder[a.mastery] ?? 2;
        const bPriority = priorityOrder[b.mastery] ?? 2;
        return aPriority - bPriority;
    });
};

/**
 * Get all grades (for selection screen)
 */
export const getAllGrades = () => {
    return [
        { id: '7', name: '×›×™×ª×” ×–×³', emoji: '7ï¸âƒ£', range: [1, 100] },
        { id: '8', name: '×›×™×ª×” ×—×³', emoji: '8ï¸âƒ£', range: [1, 100] },
        { id: '9', name: '×›×™×ª×” ×˜×³', emoji: '9ï¸âƒ£', range: [1, 100] },
        { id: '10', name: '×›×™×ª×” ×™×³', emoji: 'ðŸ”Ÿ', range: [1, 100] },
        { id: '11', name: '×›×™×ª×” ×™××³', emoji: '1ï¸âƒ£1ï¸âƒ£', range: [1, 100] },
        { id: '12', name: '×›×™×ª×” ×™×‘×³', emoji: '1ï¸âƒ£2ï¸âƒ£', range: [1, 100] }
    ];
};

/**
 * Get topics for a specific grade
 */
export const getTopicsForGrade = (gradeId) => {
    const topics = topicsByGrade[gradeId] || [];
    return topics.map(topicName => ({
        id: topicName.replace(/\s+/g, '-'),
        name: topicName,
        icon: topicIcons[topicName] || 'ðŸ“š',
        templates: topicTemplates[topicName] || topicTemplates.default
    }));
};

export default {
    getAllGrades,
    getTopicsForGrade,
    getGradeConfig,
    getPrioritizedTopics
};